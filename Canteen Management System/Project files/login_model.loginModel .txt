
package login_model;
import com.mysql.jdbc.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class loginModel 
{
    
    Connection conn = null;
    Statement statement = null;
    ResultSet resultset= null;
    
    public loginModel()
    {
        
        try
        {
            conn = (Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/","root","");
            System.out.println("connected");
        }
        catch(Exception e)
        {
            System.out.println("e");
        }
    }
    
    // login connection check
    public boolean passCheck(String user, String pass)
    {
        try
        {
            statement =(Statement)conn.createStatement();
            resultset = statement.executeQuery("SELECT * FROM model.logintable WHERE username='"+user+"' AND password='"+pass+"'");
        
            if(resultset.next())
            {
                return true;
            }
        }
        catch(Exception e)
        {
         System.err.println(e);
        }
        return false;
    }
    
    // product table data collection
    public String[][] getInfo()
    {
        String data[][]=new String[rowCount()][4];
        try
        {
            statement=(Statement)conn.createStatement();
            resultset=statement.executeQuery("SELECT * from model.producttable");
           
            int i=0;
            while(resultset.next())
            {
            
                for(int j=0;j<4;j++)
                {
                    data[i][j]=resultset.getString(j+1);
                }
                i++;
            }
        }
        catch (Exception e)
        {
            System.err.println(e);
        }
        return data;
    }
    
    public int rowCount()
    {
        int sum=0;
        try
        {
            statement=(Statement)conn.createStatement();
            resultset=statement.executeQuery("SELECT count(product_id) as sum FROM model.producttable");
           
            if(resultset.next())
            {
                sum=resultset.getInt(1);
                
            }
        }
        catch (Exception e)
        {
            System.err.println(e);
        }
        return sum;
    }
    
    // data upload to income table
    public boolean incomeDB(String pay, String change, String total)
    {
        try
        {
            statement =(Statement)conn.createStatement();
            statement.execute("insert into model.incometable (received_amount,change_amount,total_amount)values('" + pay + "','" + change + "','" + total + "')");
        
            if(resultset.next())
            {
                return true;
            }
        }
        catch(Exception e)
        {
         System.err.println(e);
        }
        return false;
    }
    
    
    // Income table data collection
    public String[][] getInfoIncome()
    {
        String dataIncome[][]=new String[rowCountI()][5];
        try
        {
            statement=(Statement)conn.createStatement();
            resultset=statement.executeQuery("SELECT * from model.incometable");
           
            int i=0;
            while(resultset.next())
            {
            
                for(int j=0;j<5;j++)
                {
                    dataIncome[i][j]=resultset.getString(j+1);
                }
                i++;
            }
        }
        catch (Exception e)
        {
            System.err.println(e);
        }
        return dataIncome;
    }
    
    public int rowCountI()
    {
        int sum=0;
        try
        {
            statement=(Statement)conn.createStatement();
            resultset=statement.executeQuery("SELECT count(order_id) as sum FROM model.incometable");
           
            if(resultset.next())
            {
                sum=resultset.getInt(1);
                
            }
        }
        catch (Exception e)
        {
            System.err.println(e);
        }
        return sum;
    }
    
    // data upload to login table
    public boolean changePass(String newUser, String newPass)
    {
        try
        {
            statement =(Statement)conn.createStatement();
            statement.execute(" UPDATE model.logintable SET username = '"+newUser+"', password = '"+newPass+"' WHERE userId = "+1+";");
        
            if(resultset.next())
            {
                return true;
            }
        }
        catch(Exception e)
        {
         System.err.println(e);
        }
        return false;
    }
    
    // updated data upload to product table
    public boolean updateTable(String PID, String PNAME, String PTYPE, String PPRICE)
    {
        try
        {
            statement =(Statement)conn.createStatement();
            statement.execute("insert into model.producttable (product_id,product_name,about,unit_price)values('" + PID + "','" + PNAME + "','" + PTYPE + "','" + PPRICE + "')");        
            
            if(resultset.next())
            {
                return true;
            }
        }
        catch(Exception e)
        {
         System.err.println(e);
        }
        return false;
    }
    
    // remove previous row data from product table
    public boolean deletrow()
    {
        try
        {
            statement =(Statement)conn.createStatement();
            statement.execute("DELETE FROM model.producttable");        
            
            if(resultset.next())
            {
                return true;
            }
        }
        catch(Exception e)
        {
         System.err.println(e);
        }
        return false;
    }
    
    

   
}
